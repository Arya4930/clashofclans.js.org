"use strict";(self.webpackChunkclashofclans_js_org=self.webpackChunkclashofclans_js_org||[]).push([[8387],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>f});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),c=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=c(t),d=a,f=m["".concat(l,".").concat(d)]||m[d]||u[d]||o;return t?r.createElement(f,i(i({ref:n},p),{},{components:t})):r.createElement(f,i({ref:n},p))}));function f(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=d;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[m]="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=t[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},3850:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var r=t(7462),a=(t(7294),t(3905));const o={slug:"custom-events",title:"Custom Events"},i=void 0,s={unversionedId:"custom-events",id:"custom-events",title:"Custom Events",description:"The API lacks socket-based real-time events. It is recommended to implement your own custom polling system.",source:"@site/guide/custom-events.md",sourceDirName:".",slug:"/custom-events",permalink:"/guide/custom-events",draft:!1,editUrl:"https://github.com/clashperk/clashofclans.js.org/edit/master/guide/custom-events.md",tags:[],version:"current",frontMatter:{slug:"custom-events",title:"Custom Events"},sidebar:"sidebar",previous:{title:"Advanced Usage",permalink:"/guide/advanced-usage"},next:{title:"Request Override",permalink:"/guide/request-override"}},l={},c=[],p={toc:c},m="wrapper";function u(e){let{components:n,...t}=e;return(0,a.kt)(m,(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"The API lacks socket-based real-time events. It is recommended to implement your own custom polling system.\nPull data at specified intervals, compare with previous values, and emit events on change.\nConsider using Node.js clusters for efficient parallel processing.")),(0,a.kt)("p",null,"Custom events give you absolute freedom in your creativity. Let's look at a simple example which emits a custom event on clan description change."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import { Client } from 'clashofclans.js';\nconst client = new PollingClient({ keys: ['***'] });\n\nclient.events.addClans(['#8P2QG08P']);\nclient.events.setClanEvent({\n    name: 'clanDescriptionChange',\n    filter: (oldClan, newClan) => {\n        return oldClan.description !== newClan.description;\n    }\n});\n\nclient.on('clanDescriptionChange', (oldClan, newClan) => {\n    console.log(oldClan.description, newClan.description);\n});\n\n(async function () {\n    await client.events.init();\n})();\n")),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"Custom event names can be anything, but it's recommended to use a name that is related to the event.\nFor example, if you want to listen for a clan description change event, you should use ",(0,a.kt)("inlineCode",{parentName:"p"},"clanDescriptionChange"),".\nSimilarly, ",(0,a.kt)("inlineCode",{parentName:"p"},"playerNameChange")," for player name change event and ",(0,a.kt)("inlineCode",{parentName:"p"},"warStateChange")," for war state change event.\nIn other words, you should use either ",(0,a.kt)("inlineCode",{parentName:"p"},"clan"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"player")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"war")," as a prefix of custom event names."),(0,a.kt)("p",{parentName:"admonition"},"This helps with typing IntelliSense of the Code Editor / IDE."),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-js"},"client.on('clanDescriptionChange', (oldClan, newClan) => {});\n")),(0,a.kt)("p",{parentName:"admonition"},"if you hover on ",(0,a.kt)("inlineCode",{parentName:"p"},"oldClan")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"newClan"),", you will see that they are of type ",(0,a.kt)("a",{parentName:"p",href:"../docs/api/classes/Clan"},(0,a.kt)("inlineCode",{parentName:"a"},"Clan")),".")))}u.isMDXComponent=!0}}]);